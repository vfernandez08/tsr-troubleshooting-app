Core Tier 1 Decision Flow
Session Start

Generate session_id and case_number.

Stamp created_at and start_time.

Equipment Identification

ONT Details

Prompt: ‚ÄúSelect customer‚Äôs ONT type‚Äù (Nokia / Calix / Other).

Input: 12-digit ont_id (scanned from BroadHub).

Store: ont_type, ont_id.

Router Details

Prompt: ‚ÄúSelect router type‚Äù (Eero / Nokia / Customer-owned).

Input: 16-digit router_id.

Store: router_type, router_id.

Issue Classification

Prompt: ‚ÄúWhat is the customer reporting?‚Äù

No Internet (Hard Down)

Slow Speeds

Intermittent Connection

Store: issue_type, free-text issue_description.

Branch to Troubleshooting Path

Issue Type	Immediate Checks	Possible Outcomes
No Internet	‚Ä¢ ONT lights & alarms
‚Ä¢ Learned MAC/IP
‚Ä¢ Power-cycle ONT	a) Online ‚Üí resolve
b) Alarm persists ‚Üí escalate / truck roll
Slow Speeds	‚Ä¢ Device vs. multiple devices
‚Ä¢ Wi-Fi vs. wired
‚Ä¢ Run speed test next to router	a) Speeds match tier ‚Üí educate
b) Wi-Fi congestion ‚Üí channel change / band steer
c) Consistent low speeds ‚Üí Tier 2
Intermittent	‚Ä¢ Eero Insight: disconnect logs
‚Ä¢ Channel utilisation
‚Ä¢ Thermal status
‚Ä¢ Reconnect device to 5/6 GHz	a) Stable after fixes ‚Üí resolve
b) Continues ‚Üí escalate

Action & Confirmation

Record each step (TroubleshootingStep) with timestamp, action, result.

When the customer confirms service is stable, set resolution = "resolved".

Case Closure

Stamp end_time, completed_at, status (resolved, escalated, etc.).

Generate Report Row:

Copy
Edit
{case_number, agent_id, ont_type, router_type,
 issue_type, resolution, duration, created_at}
Append to troubleshooting_case table (or export CSV/PDF).

üìÑ What the End-of-Case Report Should Show
yaml
Copy
Edit
Case #:          TSR-20240525-0142
Agent:           Tier1_ConnorB
Start / End:     14:22 ‚Üí 14:31  (9m 34s)
Customer Equip:  ONT Nokia G-010G (****4561)
                 Router Eero Pro 6 (****A12F)
Issue Reported:  Intermittent Connection
Key Steps:
  ‚Ä¢ Checked Insight: high 5 GHz utilisation 88%
  ‚Ä¢ Customer moved TV to 5 GHz; cleared disconnects
Resolution:       Resolved at Tier 1
(Names / phone / address omitted or masked.)

How to Implement
Decision tree dict matches the six stages above.

Each POST stores fields into TroubleshootingCase and TroubleshootingStep.

A ‚ÄúFinish Case‚Äù button triggers the report export (HTML, PDF, or DB row).

Follow this sequence and you‚Äôll avoid looped prompts and ensure every session logs complete, consistent data. Let me know if you‚Äôd like the exact code snippets to enforce this flow in your current Flask file.